{"version":3,"names":["createStore","useStore","NDKRelaySet","wrapEvent","useCallback","useEffect","useMemo","useRef","useNDK","useNDKSessionStore","arrayFrom","createSubscribeStore","bufferMs","set","get","buffer","Map","timeout","flushBuffer","state","eventMap","start","performance","now","forEach","event","tagId","currentEvent","created_at","events","Array","from","values","end","clear","eose","isSubscribed","subscriptionRef","undefined","addEvent","setTimeout","removeEventId","id","delete","setEose","clearTimeout","reset","setSubscription","sub","useSubscribe","filters","opts","relays","ndk","muteList","s","store","storeInstance","eventIds","relaySet","length","fromRelayUrls","has","pubkey","size","handleEvent","includeMuted","includeDeleted","isParamReplaceable","hasTag","current","wrap","once","handleEose","handleClosed","stop","subscription","subscribe","on"],"sourceRoot":"../../../src","sources":["hooks/subscribe.ts"],"mappings":"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","ignoreList":[]}
